{{- if (semverCompare ">=1.15-0" .Capabilities.KubeVersion.GitVersion) }}
# Source: cert-manager/templates/crds.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: certificates.cert-manager.io
  annotations:
    cert-manager.io/inject-ca-from-secret: 'okteto/cert-manager-webhook-ca'
  labels:
    app: 'cert-manager'
    app.kubernetes.io/name: 'cert-manager'
    app.kubernetes.io/instance: 'cert-manager'
    app.kubernetes.io/managed-by: 'Helm'
    helm.sh/chart: 'cert-manager-v1.1.0'
spec:
  group: cert-manager.io
  names:
    kind: Certificate
    listKind: CertificateList
    plural: certificates
    shortNames:
      - cert
      - certs
    singular: certificate
  scope: Namespaced
  conversion:
    # a Webhook strategy instruct API server to call an external webhook for any conversion between custom resources.
    strategy: Webhook
    # webhookClientConfig is required when strategy is `Webhook` and it configures the webhook endpoint to be called by API server.
    webhook:
      conversionReviewVersions: ["v1", "v1beta1"]
      clientConfig:
        service:
          namespace: 'okteto'
          name: 'cert-manager-webhook'
          path: /convert
  versions:
    - name: v1alpha2
      subresources:
        status: {}
      additionalPrinterColumns:
        - jsonPath: .status.conditions[?(@.type=="Ready")].status
          name: Ready
          type: string
        - jsonPath: .spec.secretName
          name: Secret
          type: string
        - jsonPath: .spec.issuerRef.name
          name: Issuer
          priority: 1
          type: string
        - jsonPath: .status.conditions[?(@.type=="Ready")].message
          name: Status
          priority: 1
          type: string
        - jsonPath: .metadata.creationTimestamp
          name: Age
          type: date
      schema:
        openAPIV3Schema:
          type: object
          properties:
            apiVersion:
              type: string
            kind:
              type: string
            metadata:
              type: object
            spec:
              type: object
              required:
                - issuerRef
                - secretName
              properties:
                commonName:
                  type: string
                dnsNames:
                  type: array
                  items:
                    type: string
                duration:
                  type: string
                emailSANs:
                  type: array
                  items:
                    type: string
                encodeUsagesInRequest:
                  type: boolean
                ipAddresses:
                  type: array
                  items:
                    type: string
                isCA:
                  type: boolean
                issuerRef:
                  type: object
                  required:
                    - name
                  properties:
                    group:
                      type: string
                    kind:
                      type: string
                    name:
                      type: string
                keyAlgorithm:
                  type: string
                  enum:
                    - rsa
                    - ecdsa
                keyEncoding:
                  type: string
                  enum:
                    - pkcs1
                    - pkcs8
                keySize:
                  type: integer
                  maximum: 8192
                  minimum: 0
                keystores:
                  type: object
                  properties:
                    jks:
                      type: object
                      required:
                        - create
                        - passwordSecretRef
                      properties:
                        create:
                          type: boolean
                        passwordSecretRef:
                          type: object
                          required:
                            - name
                          properties:
                            key:
                              type: string
                            name:
                              type: string
                    pkcs12:
                      type: object
                      required:
                        - create
                        - passwordSecretRef
                      properties:
                        create:
                          type: boolean
                        passwordSecretRef:
                          type: object
                          required:
                            - name
                          properties:
                            key:
                              type: string
                            name:
                              type: string
                organization:
                  type: array
                  items:
                    type: string
                privateKey:
                  type: object
                  properties:
                    rotationPolicy:
                      type: string
                renewBefore:
                  type: string
                secretName:
                  type: string
                subject:
                  type: object
                  properties:
                    countries:
                      type: array
                      items:
                        type: string
                    localities:
                      type: array
                      items:
                        type: string
                    organizationalUnits:
                      type: array
                      items:
                        type: string
                    postalCodes:
                      type: array
                      items:
                        type: string
                    provinces:
                      type: array
                      items:
                        type: string
                    serialNumber:
                      type: string
                    streetAddresses:
                      type: array
                      items:
                        type: string
                uriSANs:
                  type: array
                  items:
                    type: string
                usages:
                  type: array
                  items:
                    type: string
                    enum:
                      - signing
                      - digital signature
                      - content commitment
                      - key encipherment
                      - key agreement
                      - data encipherment
                      - cert sign
                      - crl sign
                      - encipher only
                      - decipher only
                      - any
                      - server auth
                      - client auth
                      - code signing
                      - email protection
                      - s/mime
                      - ipsec end system
                      - ipsec tunnel
                      - ipsec user
                      - timestamping
                      - ocsp signing
                      - microsoft sgc
                      - netscape sgc
            status:
              type: object
              properties:
                conditions:
                  type: array
                  items:
                    type: object
                    required:
                      - status
                      - type
                    properties:
                      lastTransitionTime:
                        type: string
                        format: date-time
                      message:
                        type: string
                      reason:
                        type: string
                      status:
                        type: string
                        enum:
                          - "True"
                          - "False"
                          - Unknown
                      type:
                        type: string
                lastFailureTime:
                  type: string
                  format: date-time
                nextPrivateKeySecretName:
                  type: string
                notAfter:
                  type: string
                  format: date-time
                notBefore:
                  type: string
                  format: date-time
                renewalTime:
                  type: string
                  format: date-time
                revision:
                  type: integer
      served: true
      storage: false
    - name: v1alpha3
      subresources:
        status: {}
      additionalPrinterColumns:
        - jsonPath: .status.conditions[?(@.type=="Ready")].status
          name: Ready
          type: string
        - jsonPath: .spec.secretName
          name: Secret
          type: string
        - jsonPath: .spec.issuerRef.name
          name: Issuer
          priority: 1
          type: string
        - jsonPath: .status.conditions[?(@.type=="Ready")].message
          name: Status
          priority: 1
          type: string
        - jsonPath: .metadata.creationTimestamp
          name: Age
          type: date
      schema:
        openAPIV3Schema:
          type: object
          properties:
            apiVersion:
              type: string
            kind:
              type: string
            metadata:
              type: object
            spec:
              type: object
              required:
                - issuerRef
                - secretName
              properties:
                commonName:
                  type: string
                dnsNames:
                  type: array
                  items:
                    type: string
                duration:
                  type: string
                emailSANs:
                  type: array
                  items:
                    type: string
                encodeUsagesInRequest:
                  type: boolean
                ipAddresses:
                  type: array
                  items:
                    type: string
                isCA:
                  type: boolean
                issuerRef:
                  type: object
                  required:
                    - name
                  properties:
                    group:
                      type: string
                    kind:
                      type: string
                    name:
                      type: string
                keyAlgorithm:
                  type: string
                  enum:
                    - rsa
                    - ecdsa
                keyEncoding:
                  type: string
                  enum:
                    - pkcs1
                    - pkcs8
                keySize:
                  type: integer
                  maximum: 8192
                  minimum: 0
                keystores:
                  type: object
                  properties:
                    jks:
                      type: object
                      required:
                        - create
                        - passwordSecretRef
                      properties:
                        create:
                          type: boolean
                        passwordSecretRef:
                          type: object
                          required:
                            - name
                          properties:
                            key:
                              type: string
                            name:
                              type: string
                    pkcs12:
                      type: object
                      required:
                        - create
                        - passwordSecretRef
                      properties:
                        create:
                          type: boolean
                        passwordSecretRef:
                          type: object
                          required:
                            - name
                          properties:
                            key:
                              type: string
                            name:
                              type: string
                privateKey:
                  type: object
                  properties:
                    rotationPolicy:
                      type: string
                renewBefore:
                  type: string
                secretName:
                  type: string
                subject:
                  type: object
                  properties:
                    countries:
                      type: array
                      items:
                        type: string
                    localities:
                      type: array
                      items:
                        type: string
                    organizationalUnits:
                      type: array
                      items:
                        type: string
                    organizations:
                      type: array
                      items:
                        type: string
                    postalCodes:
                      type: array
                      items:
                        type: string
                    provinces:
                      type: array
                      items:
                        type: string
                    serialNumber:
                      type: string
                    streetAddresses:
                      type: array
                      items:
                        type: string
                uriSANs:
                  type: array
                  items:
                    type: string
                usages:
                  type: array
                  items:
                    type: string
                    enum:
                      - signing
                      - digital signature
                      - content commitment
                      - key encipherment
                      - key agreement
                      - data encipherment
                      - cert sign
                      - crl sign
                      - encipher only
                      - decipher only
                      - any
                      - server auth
                      - client auth
                      - code signing
                      - email protection
                      - s/mime
                      - ipsec end system
                      - ipsec tunnel
                      - ipsec user
                      - timestamping
                      - ocsp signing
                      - microsoft sgc
                      - netscape sgc
            status:
              type: object
              properties:
                conditions:
                  type: array
                  items:
                    type: object
                    required:
                      - status
                      - type
                    properties:
                      lastTransitionTime:
                        type: string
                        format: date-time
                      message:
                        type: string
                      reason:
                        type: string
                      status:
                        type: string
                        enum:
                          - "True"
                          - "False"
                          - Unknown
                      type:
                        type: string
                lastFailureTime:
                  type: string
                  format: date-time
                nextPrivateKeySecretName:
                  type: string
                notAfter:
                  type: string
                  format: date-time
                notBefore:
                  type: string
                  format: date-time
                renewalTime:
                  type: string
                  format: date-time
                revision:
                  type: integer
      served: true
      storage: false
    - name: v1beta1
      subresources:
        status: {}
      additionalPrinterColumns:
        - jsonPath: .status.conditions[?(@.type=="Ready")].status
          name: Ready
          type: string
        - jsonPath: .spec.secretName
          name: Secret
          type: string
        - jsonPath: .spec.issuerRef.name
          name: Issuer
          priority: 1
          type: string
        - jsonPath: .status.conditions[?(@.type=="Ready")].message
          name: Status
          priority: 1
          type: string
        - jsonPath: .metadata.creationTimestamp
          name: Age
          type: date
      schema:
        openAPIV3Schema:
          type: object
          required:
            - spec
          properties:
            apiVersion:
              type: string
            kind:
              type: string
            metadata:
              type: object
            spec:
              type: object
              required:
                - issuerRef
                - secretName
              properties:
                commonName:
                  type: string
                dnsNames:
                  type: array
                  items:
                    type: string
                duration:
                  type: string
                emailSANs:
                  type: array
                  items:
                    type: string
                encodeUsagesInRequest:
                  type: boolean
                ipAddresses:
                  type: array
                  items:
                    type: string
                isCA:
                  type: boolean
                issuerRef:
                  type: object
                  required:
                    - name
                  properties:
                    group:
                      type: string
                    kind:
                      type: string
                    name:
                      type: string
                keystores:
                  type: object
                  properties:
                    jks:
                      type: object
                      required:
                        - create
                        - passwordSecretRef
                      properties:
                        create:
                          type: boolean
                        passwordSecretRef:
                          type: object
                          required:
                            - name
                          properties:
                            key:
                              type: string
                            name:
                              type: string
                    pkcs12:
                      type: object
                      required:
                        - create
                        - passwordSecretRef
                      properties:
                        create:
                          type: boolean
                        passwordSecretRef:
                          type: object
                          required:
                            - name
                          properties:
                            key:
                              type: string
                            name:
                              type: string
                privateKey:
                  type: object
                  properties:
                    algorithm:
                      type: string
                      enum:
                        - RSA
                        - ECDSA
                    encoding:
                      type: string
                      enum:
                        - PKCS1
                        - PKCS8
                    rotationPolicy:
                      type: string
                    size:
                      type: integer
                      maximum: 8192
                      minimum: 0
                renewBefore:
                  type: string
                secretName:
                  type: string
                subject:
                  type: object
                  properties:
                    countries:
                      type: array
                      items:
                        type: string
                    localities:
                      type: array
                      items:
                        type: string
                    organizationalUnits:
                      type: array
                      items:
                        type: string
                    organizations:
                      type: array
                      items:
                        type: string
                    postalCodes:
                      type: array
                      items:
                        type: string
                    provinces:
                      type: array
                      items:
                        type: string
                    serialNumber:
                      type: string
                    streetAddresses:
                      type: array
                      items:
                        type: string
                uriSANs:
                  type: array
                  items:
                    type: string
                usages:
                  type: array
                  items:
                    type: string
                    enum:
                      - signing
                      - digital signature
                      - content commitment
                      - key encipherment
                      - key agreement
                      - data encipherment
                      - cert sign
                      - crl sign
                      - encipher only
                      - decipher only
                      - any
                      - server auth
                      - client auth
                      - code signing
                      - email protection
                      - s/mime
                      - ipsec end system
                      - ipsec tunnel
                      - ipsec user
                      - timestamping
                      - ocsp signing
                      - microsoft sgc
                      - netscape sgc
            status:
              type: object
              properties:
                conditions:
                  type: array
                  items:
                    type: object
                    required:
                      - status
                      - type
                    properties:
                      lastTransitionTime:
                        type: string
                        format: date-time
                      message:
                        type: string
                      reason:
                        type: string
                      status:
                        type: string
                        enum:
                          - "True"
                          - "False"
                          - Unknown
                      type:
                        type: string
                lastFailureTime:
                  type: string
                  format: date-time
                nextPrivateKeySecretName:
                  type: string
                notAfter:
                  type: string
                  format: date-time
                notBefore:
                  type: string
                  format: date-time
                renewalTime:
                  type: string
                  format: date-time
                revision:
                  type: integer
      served: true
      storage: false
    - name: v1
      subresources:
        status: {}
      additionalPrinterColumns:
        - jsonPath: .status.conditions[?(@.type=="Ready")].status
          name: Ready
          type: string
        - jsonPath: .spec.secretName
          name: Secret
          type: string
        - jsonPath: .spec.issuerRef.name
          name: Issuer
          priority: 1
          type: string
        - jsonPath: .status.conditions[?(@.type=="Ready")].message
          name: Status
          priority: 1
          type: string
        - jsonPath: .metadata.creationTimestamp
          name: Age
          type: date
      schema:
        openAPIV3Schema:
          type: object
          required:
            - spec
          properties:
            apiVersion:
              type: string
            kind:
              type: string
            metadata:
              type: object
            spec:
              type: object
              required:
                - issuerRef
                - secretName
              properties:
                commonName:
                  type: string
                dnsNames:
                  type: array
                  items:
                    type: string
                duration:
                  type: string
                emailAddresses:
                  type: array
                  items:
                    type: string
                encodeUsagesInRequest:
                  type: boolean
                ipAddresses:
                  type: array
                  items:
                    type: string
                isCA:
                  type: boolean
                issuerRef:
                  type: object
                  required:
                    - name
                  properties:
                    group:
                      type: string
                    kind:
                      type: string
                    name:
                      type: string
                keystores:
                  type: object
                  properties:
                    jks:
                      type: object
                      required:
                        - create
                        - passwordSecretRef
                      properties:
                        create:
                          type: boolean
                        passwordSecretRef:
                          type: object
                          required:
                            - name
                          properties:
                            key:
                              type: string
                            name:
                              type: string
                    pkcs12:
                      type: object
                      required:
                        - create
                        - passwordSecretRef
                      properties:
                        create:
                          type: boolean
                        passwordSecretRef:
                          type: object
                          required:
                            - name
                          properties:
                            key:
                              type: string
                            name:
                              type: string
                privateKey:
                  type: object
                  properties:
                    algorithm:
                      type: string
                      enum:
                        - RSA
                        - ECDSA
                    encoding:
                      type: string
                      enum:
                        - PKCS1
                        - PKCS8
                    rotationPolicy:
                      type: string
                    size:
                      type: integer
                      maximum: 8192
                      minimum: 0
                renewBefore:
                  type: string
                secretName:
                  type: string
                subject:
                  type: object
                  properties:
                    countries:
                      type: array
                      items:
                        type: string
                    localities:
                      type: array
                      items:
                        type: string
                    organizationalUnits:
                      type: array
                      items:
                        type: string
                    organizations:
                      type: array
                      items:
                        type: string
                    postalCodes:
                      type: array
                      items:
                        type: string
                    provinces:
                      type: array
                      items:
                        type: string
                    serialNumber:
                      type: string
                    streetAddresses:
                      type: array
                      items:
                        type: string
                uris:
                  type: array
                  items:
                    type: string
                usages:
                  type: array
                  items:
                    type: string
                    enum:
                      - signing
                      - digital signature
                      - content commitment
                      - key encipherment
                      - key agreement
                      - data encipherment
                      - cert sign
                      - crl sign
                      - encipher only
                      - decipher only
                      - any
                      - server auth
                      - client auth
                      - code signing
                      - email protection
                      - s/mime
                      - ipsec end system
                      - ipsec tunnel
                      - ipsec user
                      - timestamping
                      - ocsp signing
                      - microsoft sgc
                      - netscape sgc
            status:
              type: object
              properties:
                conditions:
                  type: array
                  items:
                    type: object
                    required:
                      - status
                      - type
                    properties:
                      lastTransitionTime:
                        type: string
                        format: date-time
                      message:
                        type: string
                      reason:
                        type: string
                      status:
                        type: string
                        enum:
                          - "True"
                          - "False"
                          - Unknown
                      type:
                        type: string
                lastFailureTime:
                  type: string
                  format: date-time
                nextPrivateKeySecretName:
                  type: string
                notAfter:
                  type: string
                  format: date-time
                notBefore:
                  type: string
                  format: date-time
                renewalTime:
                  type: string
                  format: date-time
                revision:
                  type: integer
      served: true
      storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
{{- end }}